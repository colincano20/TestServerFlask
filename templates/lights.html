<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Light Control</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='lights.css') }}">
    <script>
  const noCache = { headers: { "Cache-Control": "no-cache" } };

  function debounce(fn, ms=120) {
    let t;
    return (...args) => { clearTimeout(t); t = setTimeout(() => fn(...args), ms); };
  }

  const setBrightness = debounce(async (value) => {
    try { await fetch(`/lights/brightness/${value}`, noCache); } catch {}
  });

  async function setColor(color) {
    try { await fetch(`/lights/color/${color.replace('#','')}`, noCache); } catch {}
  }

  const setHue = debounce(async (value) => {
    try { await fetch(`/lights/hue/${value}`, noCache); } catch {}
  });

  const setSaturation = debounce(async (value) => {
    try { await fetch(`/lights/saturation/${value}`, noCache); } catch {}
  });
</script>

</head>
<body>
    <div class="background-glow">
    <div class="container">
        <h1>ðŸ’¡ Light Control</h1>

        <div class="button-group">
            <a href="/lights/on" class="btn on">Turn On</a>
            <a href="/lights/off" class="btn off">Turn Off</a>
        </div>

        <div class="control">
            <label>Brightness: <span id="brightness-value">50</span>%</label>
            <input type="range" min="0" max="100" value="50" 
                   oninput="document.getElementById('brightness-value').innerText=this.value; setBrightness(this.value)">
        </div>

        <div class="control">
            <label>Color Picker:</label>
            <input type="color" value="#ffffff" oninput="setColor(this.value)">
        </div>

        

        <div class="footer">
            <a href="/dashboard" class="btn back">Back</a>
        </div>
    </div>
    </div>
</body>
</html>
